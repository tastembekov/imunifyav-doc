<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Command-Line Interface | Documentation</title>
    <meta name="description" content="ImunifyAV documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.8709e144.css" as="style"><link rel="preload" href="/assets/js/app.c1c80950.js" as="script"><link rel="preload" href="/assets/js/4.4ba4e2f8.js" as="script"><link rel="prefetch" href="/assets/js/3.202dcbb0.js"><link rel="prefetch" href="/assets/js/5.3ae94ceb.js"><link rel="prefetch" href="/assets/js/6.d1748244.js"><link rel="prefetch" href="/assets/js/7.48bcc0ed.js"><link rel="prefetch" href="/assets/js/8.aaf2d119.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.96cf288f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8709e144.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <div class="search-box"><input aria-label="Search" placeholder="Search" autocomplete="off" spellcheck="false" value="Search"> <!----></div> <div class="links" style="max-width:nullpx;"><a href="https://www.imunify360.com/antivirus" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><a href="/imunifyav/" class="sidebar-link">ImunifyAV for cPanel and DirectAdmin</a></li><li><a href="/cli/" class="active sidebar-link">Command-Line Interface</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cli/#start" class="sidebar-link">Start</a></li><li class="sidebar-sub-header"><a href="/cli/#add-sudouser" class="sidebar-link">Add-sudouser</a></li><li class="sidebar-sub-header"><a href="/cli/#сheckdb" class="sidebar-link">Сheckdb</a></li><li class="sidebar-sub-header"><a href="/cli/#delete-sudouser" class="sidebar-link">Delete-sudouser</a></li><li class="sidebar-sub-header"><a href="/cli/#disable-plugin" class="sidebar-link">Disable-plugin</a></li><li class="sidebar-sub-header"><a href="/cli/#doctor" class="sidebar-link">Doctor</a></li><li class="sidebar-sub-header"><a href="/cli/#enable-plugin" class="sidebar-link">Enable-plugin</a></li><li class="sidebar-sub-header"><a href="/cli/#register" class="sidebar-link">Register</a></li><li class="sidebar-sub-header"><a href="/cli/#rstatus" class="sidebar-link">Rstatus</a></li><li class="sidebar-sub-header"><a href="/cli/#unregister" class="sidebar-link">Unregister</a></li><li class="sidebar-sub-header"><a href="/cli/#update" class="sidebar-link">Update</a></li><li class="sidebar-sub-header"><a href="/cli/#update-license" class="sidebar-link">Update-license</a></li><li class="sidebar-sub-header"><a href="/cli/#version" class="sidebar-link">Version</a></li><li class="sidebar-sub-header"><a href="/cli/#feature-management" class="sidebar-link">Feature-management</a></li><li class="sidebar-sub-header"><a href="/cli/#malware" class="sidebar-link">Malware</a></li></ul></li><li><a href="/imunifyav_for_plesk/" class="sidebar-link">ImunifyAV/ImunifyAV+ for Plesk</a></li><li><a href="/imunifyav_for_ispmanager/" class="sidebar-link">ImunifyAV/ImunifyAV+ for ISPmanager</a></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/cli/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    Command-Line Interface
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/imunifyav/" class="link prev">
      ←
    </a> <a href="/imunifyav_for_plesk/" class="link">
      →
    </a></div></div> <div class="content"><h1 id="command-line-interface"><a href="#command-line-interface" aria-hidden="true" class="header-anchor">#</a> Command-Line Interface</h1> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>CLI commands are available only for cPanel and DirectAdmin control panels. Plesk and ISPmanager CLI support is coming soon.</p></div> <p>For access to ImunifyAV agent features from the command-line interface, use the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus
</code></pre></div><p><strong>Optional arguments:</strong></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h</code>, <code>--help</code></td> <td>show this help message and exit</td></tr> <tr><td><code>--console-log-level {ERROR,WARNING,INFO,DEBUG}</code></td> <td>level of logging input to the console</td></tr></tbody></table> <p><strong>Basic usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus [command] [--option1] [--option2]... 
</code></pre></div><p><strong>Available commands:</strong></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>start</code></td> <td>start the agent</td></tr> <tr><td><code>add-sudouser</code></td> <td>add a user with root privileges</td></tr> <tr><td><code>checkdb</code></td> <td>check database integrity</td></tr> <tr><td><code>delete-sudouser</code></td> <td>remove a user with root privileges</td></tr> <tr><td><code>disable-plugin</code></td> <td>disable hosting panel plugin</td></tr> <tr><td><code>doctor</code></td> <td>collect info about the system and send it to ImunifyAV</td></tr> <tr><td><code>enable-plugin</code></td> <td>enable hosting panel plugin (if detected)</td></tr> <tr><td><code>register</code></td> <td>register the agent</td></tr> <tr><td><code>rstatus</code></td> <td>send a query to server to the check if the license is valid</td></tr> <tr><td><code>unregister</code></td> <td>unregister the agent</td></tr> <tr><td><code>update</code></td> <td>update malware signatures</td></tr> <tr><td><code>update-license</code></td> <td>force license update</td></tr> <tr><td><code>version</code></td> <td>show version</td></tr> <tr><td><code>feature-management</code></td> <td>manage ImunifyAV features available for users</td></tr> <tr><td><code>malware</code></td> <td>malware-related operations</td></tr></tbody></table> <h2 id="start"><a href="#start" aria-hidden="true" class="header-anchor">#</a> Start</h2> <p>This command allows to run the agent.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus start [--optional arguments]
</code></pre></div><h2 id="add-sudouser"><a href="#add-sudouser" aria-hidden="true" class="header-anchor">#</a> Add-sudouser</h2> <p>This command adds a user with root privileges to the server.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus add-sudouser &lt;userID&gt; [--optional arguments]
</code></pre></div><h2 id="сheckdb"><a href="#сheckdb" aria-hidden="true" class="header-anchor">#</a> Сheckdb</h2> <p>Checks database integrity. In case database is corrupt, then this command saves backup copy of the database at <code>/var/imunifyav</code> and tries to restore integrity of the original database.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>If this command cannot restore database integrity, then it will destroy the original broken database.</p></div> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus checkdb [--optional arguments]
</code></pre></div><h2 id="delete-sudouser"><a href="#delete-sudouser" aria-hidden="true" class="header-anchor">#</a> Delete-sudouser</h2> <p>This command removes a user with root privileges from the server.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus delete-sudouser &lt;userID&gt; [--optional arguments]
</code></pre></div><h2 id="disable-plugin"><a href="#disable-plugin" aria-hidden="true" class="header-anchor">#</a> Disable-plugin</h2> <p>This command disables hosting panel default malware plugin.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus disable-plugin &lt;panel&gt; [--optional arguments]
</code></pre></div><h2 id="doctor"><a href="#doctor" aria-hidden="true" class="header-anchor">#</a> Doctor</h2> <p>This command collects information about ImunifyAV state, generates the report and sends it to the ImunifyAV Support Team. This command can be used in case of any troubles or issues with ImunifyAV. This command will generate a key to be sent to the ImunifyAV Support Team. With that key the ImunifyAV Support Team can help with any problem as fast as possible.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus doctor [--optional arguments]
</code></pre></div><h2 id="enable-plugin"><a href="#enable-plugin" aria-hidden="true" class="header-anchor">#</a> Enable-plugin</h2> <p>This command enables hosting panel default malware plugin if it was detected.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus enable-plugin &lt;panel&gt; [--optional arguments]
</code></pre></div><h2 id="register"><a href="#register" aria-hidden="true" class="header-anchor">#</a> Register</h2> <p>Allows to register and activate ImunifyAV. You can use it in case if ImunifyAV was not activated during installation process or in case if activation key of the ImunifyAV was changed for any reason. If you do not know what is an activation key or have any problem with it then, please, read <a href="/imunifyav/#installation-guide">Installation Guide</a> or <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">contact our support team<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus register [--optional arguments] [KEY]
</code></pre></div><p><code>KEY</code> is a positional argument:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>KEY</code></td> <td>register with activation key (use <code>IPL</code> to register by IP)</td></tr></tbody></table> <p>If you will use this command without the <code>KEY</code> argument, then it will try to register and activate current activation key.</p> <p><strong>Example 1:</strong>
The following command will register and activate Imunify360 with the provided activation key:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus register IMAV250jjRRjowbjk56dGN
</code></pre></div><p><strong>Example 2:</strong>
If you have an IP-based license, you can use <code>IPL</code> argument to register and activate ImunifyAV:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus register IPL
</code></pre></div><h2 id="rstatus"><a href="#rstatus" aria-hidden="true" class="header-anchor">#</a> Rstatus</h2> <p>Allows to check if ImunifyAV server license is valid.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus rstatus [--optional arguments]
</code></pre></div><h2 id="unregister"><a href="#unregister" aria-hidden="true" class="header-anchor">#</a> Unregister</h2> <p>Allows to unregister and disable ImunifyAV on the server.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus unregister [--optional arguments]
</code></pre></div><h2 id="update"><a href="#update" aria-hidden="true" class="header-anchor">#</a> Update</h2> <p>This command allows updating ImunifyAV malware signatures.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus update [--optional arguments] signatures
</code></pre></div><h2 id="update-license"><a href="#update-license" aria-hidden="true" class="header-anchor">#</a> Update-license</h2> <p>This command force updating the ImunifyAV license.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus update-license [--optional arguments]
</code></pre></div><h2 id="version"><a href="#version" aria-hidden="true" class="header-anchor">#</a> Version</h2> <p>Allows to show the actual ImunifyAV version installed on the server.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus version [--optional arguments]
</code></pre></div><h2 id="feature-management"><a href="#feature-management" aria-hidden="true" class="header-anchor">#</a> Feature-management</h2> <p>Allows to manage ImunifyAV features available for users.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus feature-management [command] [--optional argument]...
</code></pre></div><p><code>Command</code> can be one of the following:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>defaults</code></td> <td>show the default value for each feature that is applied for newly created user</td></tr> <tr><td><code>disable</code></td> <td>disable a feature for some or all users</td></tr> <tr><td><code>enable</code></td> <td>enable a feature for some or all users</td></tr> <tr><td><code>get</code></td> <td>obtains the status of all available features for a <code>USER</code></td></tr> <tr><td><code>list</code></td> <td>list all available features</td></tr></tbody></table> <p><code>Optional argument</code> for the <code>enable/disable</code> commands can be one of the following:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>[--feature cleanup]</code></td> <td>specifies which feature to enable/disable</td></tr> <tr><td><code>[--users [USERS [USERS ...]]]</code></td> <td>specifies the list of users which will be affected, otherwise the default value will be changed</td></tr></tbody></table> <p>The mandatory argument for the <code>get</code> command:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>[--user USER]</code></td> <td>specifies a user name to obtain the status of features for</td></tr></tbody></table> <p><strong>Example:</strong></p> <p>The following command enables malware cleanup feature for the <code>user1</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus feature-management enable --feature cleanup --users user1
</code></pre></div><h2 id="malware"><a href="#malware" aria-hidden="true" class="header-anchor">#</a> Malware</h2> <p>Allows to manage malware-related operation.</p> <p><strong>Usage:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus malware [command] [--argument]...
</code></pre></div><p><code>Command</code> can be one of the following:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>cleanup status</code></td> <td>show the status of the cleanup process</td></tr> <tr><td><code>hash</code></td> <td>allows to manage hashes</td></tr> <tr><td><code>history list</code></td> <td>lists the complete history of all malware-related incidents/actions (optional arguments available)</td></tr> <tr><td><code>ignore</code></td> <td>allows to add, delete or show files which will not be scanned</td></tr> <tr><td><code>malicious</code></td> <td>allows to manage malicious files</td></tr> <tr><td><code>on-demand</code></td> <td>allows to manage on-demand scanner</td></tr> <tr><td><code>read</code></td> <td>allows to read malware files</td></tr> <tr><td><code>suspicious</code></td> <td>allows to manage suspicious files</td></tr></tbody></table> <p>The optional arguments are:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--order-by [ORDER_BY [ORDER_BY ...]]</code></td> <td>sorting order</td></tr> <tr><td><code>--limit LIMIT</code></td> <td>limits the output; must be a number greater than zero (by default, equals 100)</td></tr> <tr><td><code>--since SINCE</code></td> <td>start date</td></tr> <tr><td><code>--offset OFFSET</code></td> <td>offset for pagination (by default, equals 0)</td></tr> <tr><td><code>--user USER</code></td> <td>returns results for a chosen user</td></tr> <tr><td><code>--to TO</code></td> <td>end date</td></tr> <tr><td><code>--search SEARCH</code></td> <td>search query</td></tr></tbody></table> <p><code>action</code> is the second positional argument for <code>hash</code> and can be one of the following:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>list</code></td> <td>list added hashes</td></tr> <tr><td><code>add</code></td> <td>add file hashes of the specified type</td></tr> <tr><td><code>remove</code></td> <td>remove file hashes of the specified type</td></tr></tbody></table> <p>Positional argument for <code>add/remove</code> is the list of SHA256 hashes calculated from the file contents</p> <p>The argument that specifies which kind of hashes to add/remove:</p> <div class="language- extra-class"><pre class="language-text"><code>--type -- hash(es) type: black or white
</code></pre></div><p><code>command</code> is a second positional argument for <code>ignore</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>add</code></td> <td>add a file or files divided by space to the Ignore List</td></tr> <tr><td><code>delete</code></td> <td>delete an ignored file or files divided by space from the list</td></tr> <tr><td><code>list</code></td> <td>show a list of ignored files</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>malicious</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>delete</code></td> <td>delete malicious file or files divided by space</td></tr> <tr><td><code>list</code></td> <td>show a list of malicious files</td></tr> <tr><td><code>move-to-ignore</code></td> <td>move a file or files divided by space to the Ignore List</td></tr> <tr><td><code>quarantine-malicious</code></td> <td>allows to add malicious files to quarantine</td></tr> <tr><td><code>restore-from-backup</code></td> <td>restore source files from backup</td></tr> <tr><td><code>restore-from-quarantine</code></td> <td>restore files from quarantine</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>on-demand</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>start</code></td> <td>start on-demand scanner for the path specified after the start command</td></tr> <tr><td><code>list</code></td> <td>returns a list of all on-demand scanner session results</td></tr> <tr><td><code>status</code></td> <td>show current status for on-demand scanner</td></tr> <tr><td><code>stop</code></td> <td>stop current scanning</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>suspicious</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>delete</code></td> <td>delete suspicious file or files divided by space</td></tr> <tr><td><code>list</code></td> <td>show a list of suspicious files</td></tr> <tr><td><code>move-to-ignore</code></td> <td>move suspicious files divided by space to the Ignore List</td></tr> <tr><td><code>move-to-quarantine</code></td> <td>move suspicious files divided by space to the quarantine</td></tr></tbody></table> <p><strong>Examples</strong></p> <ol><li>The following command adds a hash to the malware Black List:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus malware hash add --type black ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad
</code></pre></div><ol start="2"><li>The following command starts on-demand scanner for the path specified after the <code>start</code> command:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus malware on-demand start --path /home/&lt;username&gt;/public_html/
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/cli/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> </div> <div class="footer" data-v-60d85658><div data-v-60d85658><a href="https://cloudlinux.com" data-v-60d85658><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-60d85658></a></div> <div class="footer-company-title" data-v-60d85658>2019. CloudLinux Inc</div> <div data-v-60d85658><div data-v-60d85658><a href="https://cloudlinux.zendesk.com/hc/sections/115001344329-How-do-I" target="_blank" data-v-60d85658>How to</a></div><div data-v-60d85658><a href="https://www.imunify360.com/antivirus" target="_blank" data-v-60d85658>Getting started</a></div><div data-v-60d85658><a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" data-v-60d85658>Contact support</a></div><div data-v-60d85658><a href="https://www.imunify360.com/blog" target="_blank" data-v-60d85658>Blog</a></div></div> <div class="social" data-v-60d85658><span class="footer-social-text" data-v-60d85658>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-60d85658><img src="/fb.png" class="footer-social-logo" data-v-60d85658></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-60d85658><img src="/tw.png" class="footer-social-logo" data-v-60d85658></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-60d85658><img src="/in.png" class="footer-social-logo" data-v-60d85658></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-60d85658><img src="/ytube.png" class="footer-social-logo" data-v-60d85658></a></div></div> <!----></div></div>
    <script src="/assets/js/app.c1c80950.js" defer></script><script src="/assets/js/4.4ba4e2f8.js" defer></script>
  </body>
</html>
